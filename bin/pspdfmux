#!/bin/bash
tmux has-session -t pspdfkit
if [ $? != 0 ]; then
  tmux new-session -s pspdfkit -n 'PSPDFKit' -d
  tmux send-keys -t pspdfkit 'cd ~/dev/PSPDFKit-Web' C-m
  tmux send-keys -t pspdfkit 'yarn outdated' C-m

  tmux split-window -h -t pspdfkit -p 50
  tmux send-keys -t pspdfkit:1.2 'cd ~/dev/PSPDFKit-Web' C-m
  tmux send-keys -t pspdfkit:1.2 'yarn test:unit:watch' C-m

  tmux split-window -v -t pspdfkit:1.2
  tmux send-keys -t pspdfkit:1.3 'cd ~/dev/pssync-server' C-m
  tmux send-keys -t pspdfkit:1.3 'script/server' C-m

  tmux split-window -v -t pspdfkit:1.3
  tmux send-keys -t pspdfkit:1.4 'cd ~/dev/PSPDFKit-Web' C-m
  tmux send-keys -t pspdfkit:1.4 'yarn start' C-m
fi

tmux select-pane -t pspdfkit:1.1
tmux attach -t pspdfkit
